<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title></title>
<link type="image/x-icon" rel="shortcut icon" href="static/img/logo/favicon.ico">
<link href="static/css/bootstrap.min.css" rel="stylesheet">
<link href="static/css/font-awesome.min.css" rel="stylesheet">
<link href="static/css/animate.min.css" rel="stylesheet">
<link href="static/css/style.min.css" rel="stylesheet">
<link href="static/css/plugins/chosen/chosen.css" rel="stylesheet">
<link href="static/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
   <link href="static/css/plugins/zTree_v3/zTreeStyle/zTreeStyle.css" rel="stylesheet">
</head>

<body class="gray-bg">
	<div class="financeProduct">
		<div class="wrapper wrapper-content animated fadeInRight">
			<div class="ibox float-e-margins">
				<div class="ibox-title">
					<h5>资源管理</h5>
					<div class="ibox-tools">
						<a class="collapse-link"> <i class="fa fa-chevron-up"></i>
						</a>
					</div>
				</div>
				<div class="ibox-content">
					<div class="row">
						<button id="create" data-toggle="modal" class="btn btn-primary" data-target="#myModal2">
							<i class="fa fa-pencil"></i> 创建
						</button>
						<form method="get" action="#" class="pull-right mail-search">
							<div class="input-group">
								<input type="text" class="form-control input-sm" name="search" placeholder="请输入关键字">
								<div class="input-group-btn">
									<button type="button" id="search" class="btn btn-sm btn-primary">搜索</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="ibox float-e-margins">
				<div class="ibox-content">
					<div class="row">
						<div class="example-wrap">
							<div class="example">
								<table id="table" class="table table-hover" data-mobile-responsive="true" data-click-to-select="true">
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="modal inmodal" id="myModal2" tabindex="-1" role="dialog" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content animated flipInY">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">
							<span aria-hidden="true">&times;</span><span class="sr-only">Close</span>
						</button>
						<h4 class="modal-title">增加/修改/查看资源</h4>
					</div>
					<div class="modal-body">
						<form id="formid" role="form" class="form-horizontal" action="resource/add.do" method="post">
							<input type="hidden" name="id" id="id">
							<div class="form-group">
								<label class="col-lg-4 control-label">资源名称：</label>
								<div class="col-lg-8">
									<input type="text" name="name" placeholder="请输入资源名称" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-lg-4 control-label">上级资源：</label>
									<div class="form-group">
									
										<input type="button" class="btn btn-white" value="请选择" id="organizationInput">
										<button type="button" class="btn btn-white" onclick="showMenu();">
											<span class="caret"></span>
										</button>
										<div class="organizationTreeWrap">
											<ul id="organizationTree" class="ztree"></ul>
										</div>
										<input type="text" name="resIds" id="resIds">
										</div>
							</div>
							<div class="form-group">
								<label class="col-lg-4 control-label">资源地址：</label>
								<div class="col-lg-8">
									<input type="text" name="href" placeholder="请输入资源地址" class="form-control">
								</div>
							</div>
							<!-- <div class="form-group">
								<label class="col-lg-4 control-label">排序：</label>
								<div class="col-lg-8">
									<input type="text" name="orderNo" placeholder="请输入序号" class="form-control">
								</div>
							</div> -->
							<div class="form-group">
								<label class="col-lg-4 control-label">权限表达式：</label>
								<div class="col-lg-8">
									<input type="text" name="permission" placeholder="请输入权限表达式" class="form-control">
								</div>
							</div>
							<div class="form-group">
								<label class="col-lg-4 control-label">资源类型：</label>
								<div class="col-lg-8">
									<select class="form-control" name="resourceType">
										<option value="MENU">MENU</option>
										<option value="BUTTON">BUTTON</option>
									</select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-lg-4 control-label">删除：</label>
								<div class="col-lg-8">
									<label class="checkbox-inline"> <input type="radio" value="0" name="deleteFlag" checked="checked" id="inlineCheckbox3"> <label
										for="inlineCheckbox3">否 </label>
									</label> <label class="checkbox-inline"> <input type="radio" value="1" name="deleteFlag" id="inlineCheckbox2"> <label
										for="inlineCheckbox2">是</label>
									</label>
								</div>
							</div>
							<div class="form-group">
								<label class="col-lg-4 control-label">资源描述：</label>
								<div class="col-lg-8">
									<textarea name="description" rows="" cols="" placeholder="请输入资源描述" class="form-control"></textarea>
								</div>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-white" data-dismiss="modal">取消</button>
						<button id="save" type="button" class="btn btn-primary">保存</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src="static/js/jquery.min.js"></script>
	<script src="static/js/define/globalPath.js"></script>
	<script src="static/js/define/rest.js"></script>
	<script src="static/js/bootstrap.min.js"></script>
	<!-- <script src="static/js/contabs.min.js"></script> -->
	<script src="static/js/content.min.js"></script>
	<script src="static/js/plugins/layer/layer.min.js"></script>
	<script src="static/js/plugins/chosen/chosen.jquery.js"></script>
	<script src="static/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
	<script src="static/js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
	<script src="static/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
	  <script src="static/js/plugins/zTree_v3/jquery.ztree.all-3.5.js"></script>
	<script src="static/js/define/TreeAntiUtil.js"></script>
	<script type="text/javascript">
		$(function() {
			$.getJSON("permission/resourcelist.do",
					function(json) {
				console.info(json.data.obj)
						$.fn.zTree.init($("#organizationTree"), setting,json.data.resourceList);
					});

		});
		
	</script>

	<script type="text/javascript">
		var $table = $('#table'), $search = $('#search');
		$save = $('#save');

		$(function() {
			$save.click(function() {
				$("#formid").submit();
			});
			$search.click(function() {
				$table.bootstrapTable('refresh');
			});

		});

		function query(params) {
			return {
				name : $.trim($('#name').val())
			}
		}

		function addIndex(value, row, index) {
			var index = ++index;
			return index;
		}

		function operateFormatter(value, row, index) {
			return '<a><i class="fa fa-wrench"></i>编辑</a>'
					+ ' <a><i class="fa fa-times"></i>删除</a>'
					+ ' <a><i class="fa fa-paste"></i>查看</a>';
		}

		$table.bootstrapTable({
			method : 'get',
			/* url: "sys/list.do", */
			url : "http://beta.json-generator.com/api/json/get/DXXROxj",
			showRefresh : true,
			columns : [ {
				field : 'state',
				checkbox : true
			}, {
				title : '序号',
				formatter : addIndex
			}, {
				field : 'name',
				title : '资源名称',
				sortable : true
			}, {
				field : 'pName',
				title : '上级资源',
				sortable : true
			}, {
				field : 'href',
				title : '资源地址',
				sortable : true
			}, {
				field : 'orderNo',
				title : '排序',
				sortable : true
			}, {
				field : 'permission',
				title : '权限表达式'
			}, {
				field : 'resourceType',
				title : '资源类型'
			}, {
				field : 'deleteFlag',
				title : '删除'
			}, {
				field : 'createTime',
				title : '创建时间',
				sortable : true
			}, {
				field : 'operate',
				title : '操作',
				width : '150px',
				formatter : operateFormatter
			}

			],
			striped : true,
			pagination : true,
			pageList : [ 10 ],
			pageSize : 10,
			pageNumber : 1,
			queryParams : function(params) {
				return {
					name : $.trim($('#name').val())
				}
			}
		});
	</script>
</body>
</html>